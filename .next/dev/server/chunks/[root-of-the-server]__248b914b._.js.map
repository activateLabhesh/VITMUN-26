{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sachin%20Mehta/VITMUN_backend/VITMUN-26/lib/mongodb.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\r\n\r\n// Validate environment variables\r\nif (!process.env.MONGODB_URI) {\r\n  throw new Error(\"Please add your MongoDB URI to the .env.local file.\");\r\n}\r\n\r\nconst uri = process.env.MONGODB_URI;\r\nlet client;\r\nlet clientPromise;\r\n\r\n// Function to ensure collections are created\r\nasync function ensureCollections(client) {\r\n  const db = client.db(\"delegateinfo\"); // Database name\r\n  const collections = await db.listCollections().toArray();\r\n  const existingCollectionNames = collections.map((col) => col.name);\r\n\r\n  const requiredCollections = [\"external\", \"internal\", \"delegations\"];\r\n  for (const collectionName of requiredCollections) {\r\n    if (!existingCollectionNames.includes(collectionName)) {\r\n      await db.createCollection(collectionName);\r\n      console.log(`Collection '${collectionName}' created.`);\r\n    }\r\n  }\r\n}\r\n\r\n// Initialize MongoDB connection\r\nif (process.env.NODE_ENV === \"development\") {\r\n  // Use a global variable to persist the client during hot reloads\r\n  if (!global._mongoClientPromise) {\r\n    client = new MongoClient(uri);\r\n    global._mongoClientPromise = client.connect().then((connectedClient) => {\r\n      ensureCollections(connectedClient);\r\n      return connectedClient;\r\n    });\r\n  }\r\n  clientPromise = global._mongoClientPromise;\r\n} else {\r\n  // In production, create a new client instance\r\n  client = new MongoClient(uri);\r\n  clientPromise = client.connect().then((connectedClient) => {\r\n    ensureCollections(connectedClient);\r\n    return connectedClient;\r\n  });\r\n}\r\n\r\nexport default clientPromise;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,iCAAiC;AACjC,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,IAAI;AACJ,IAAI;AAEJ,6CAA6C;AAC7C,eAAe,kBAAkB,MAAM;IACrC,MAAM,KAAK,OAAO,EAAE,CAAC,iBAAiB,gBAAgB;IACtD,MAAM,cAAc,MAAM,GAAG,eAAe,GAAG,OAAO;IACtD,MAAM,0BAA0B,YAAY,GAAG,CAAC,CAAC,MAAQ,IAAI,IAAI;IAEjE,MAAM,sBAAsB;QAAC;QAAY;QAAY;KAAc;IACnE,KAAK,MAAM,kBAAkB,oBAAqB;QAChD,IAAI,CAAC,wBAAwB,QAAQ,CAAC,iBAAiB;YACrD,MAAM,GAAG,gBAAgB,CAAC;YAC1B,QAAQ,GAAG,CAAC,CAAC,YAAY,EAAE,eAAe,UAAU,CAAC;QACvD;IACF;AACF;AAEA,gCAAgC;AAChC,wCAA4C;IAC1C,iEAAiE;IACjE,IAAI,CAAC,yDAAO,mBAAmB,EAAE;QAC/B,SAAS,IAAI,sHAAW,CAAC;QACzB,yDAAO,mBAAmB,GAAG,OAAO,OAAO,GAAG,IAAI,CAAC,CAAC;YAClD,kBAAkB;YAClB,OAAO;QACT;IACF;IACA,gBAAgB,yDAAO,mBAAmB;AAC5C;;uCASe","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sachin%20Mehta/VITMUN_backend/VITMUN-26/src/app/api/admin/update-delegate/route.ts"],"sourcesContent":["import { ObjectId } from \"mongodb\";\r\nimport clientPromise from \"../../../../../lib/mongodb\";\r\nimport { NextResponse, NextRequest } from \"next/server\";\r\n\r\nexport async function POST(req: NextRequest) {\r\n  // Get authentication details\r\n\r\n  // If not authenticated, return a 401 Unauthorized response\r\n\r\n  try {\r\n    // Parse request body\r\n    const { type, id, allotment_committee, allotment_portfolio, paid } =\r\n      await req.json();\r\n\r\n    // Connect to the database\r\n    const client = await clientPromise;\r\n    const db = client.db(\"delegateallotments\");\r\n\r\n    // Determine the correct collection based on the type\r\n    const collection = db.collection(\r\n      type === \"external\" ? \"external\" : \"internal\"\r\n    );\r\n\r\n    // Update the document\r\n    const result = await collection.updateOne(\r\n      { _id: new ObjectId(id) },\r\n      {\r\n        $set: {\r\n          allotment_committee,\r\n          allotment_portfolio,\r\n          paid,\r\n        },\r\n      }\r\n    );\r\n\r\n    // Return success response\r\n    return NextResponse.json({ success: result.modifiedCount > 0 });\r\n  } catch (error) {\r\n    // Handle errors gracefully\r\n    console.error(\"Error updating document:\", error);\r\n    return NextResponse.json(\r\n      { error: \"Failed to update the document\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,6BAA6B;IAE7B,2DAA2D;IAE3D,IAAI;QACF,qBAAqB;QACrB,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,mBAAmB,EAAE,mBAAmB,EAAE,IAAI,EAAE,GAChE,MAAM,IAAI,IAAI;QAEhB,0BAA0B;QAC1B,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,qDAAqD;QACrD,MAAM,aAAa,GAAG,UAAU,CAC9B,SAAS,aAAa,aAAa;QAGrC,sBAAsB;QACtB,MAAM,SAAS,MAAM,WAAW,SAAS,CACvC;YAAE,KAAK,IAAI,mHAAQ,CAAC;QAAI,GACxB;YACE,MAAM;gBACJ;gBACA;gBACA;YACF;QACF;QAGF,0BAA0B;QAC1B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS,OAAO,aAAa,GAAG;QAAE;IAC/D,EAAE,OAAO,OAAO;QACd,2BAA2B;QAC3B,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAgC,GACzC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}