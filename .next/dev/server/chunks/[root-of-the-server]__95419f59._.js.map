{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sachin%20Mehta/VITMUN_backend/VITMUN-26/lib/mongodb.js"],"sourcesContent":["import { MongoClient } from \"mongodb\";\r\n\r\n// Validate environment variables\r\nif (!process.env.MONGODB_URI) {\r\n  throw new Error(\"Please add your MongoDB URI to the .env.local file.\");\r\n}\r\n\r\nconst uri = process.env.MONGODB_URI;\r\nlet client;\r\nlet clientPromise;\r\n\r\n// Function to ensure collections are created\r\nasync function ensureCollections(client) {\r\n  const db = client.db(\"delegateinfo\"); // Database name\r\n  const collections = await db.listCollections().toArray();\r\n  const existingCollectionNames = collections.map((col) => col.name);\r\n\r\n  const requiredCollections = [\"external\", \"internal\", \"delegations\"];\r\n  for (const collectionName of requiredCollections) {\r\n    if (!existingCollectionNames.includes(collectionName)) {\r\n      await db.createCollection(collectionName);\r\n      console.log(`Collection '${collectionName}' created.`);\r\n    }\r\n  }\r\n}\r\n\r\n// Initialize MongoDB connection\r\nif (process.env.NODE_ENV === \"development\") {\r\n  // Use a global variable to persist the client during hot reloads\r\n  if (!global._mongoClientPromise) {\r\n    client = new MongoClient(uri);\r\n    global._mongoClientPromise = client.connect().then((connectedClient) => {\r\n      ensureCollections(connectedClient);\r\n      return connectedClient;\r\n    });\r\n  }\r\n  clientPromise = global._mongoClientPromise;\r\n} else {\r\n  // In production, create a new client instance\r\n  client = new MongoClient(uri);\r\n  clientPromise = client.connect().then((connectedClient) => {\r\n    ensureCollections(connectedClient);\r\n    return connectedClient;\r\n  });\r\n}\r\n\r\nexport default clientPromise;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,iCAAiC;AACjC,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,IAAI;AACJ,IAAI;AAEJ,6CAA6C;AAC7C,eAAe,kBAAkB,MAAM;IACrC,MAAM,KAAK,OAAO,EAAE,CAAC,iBAAiB,gBAAgB;IACtD,MAAM,cAAc,MAAM,GAAG,eAAe,GAAG,OAAO;IACtD,MAAM,0BAA0B,YAAY,GAAG,CAAC,CAAC,MAAQ,IAAI,IAAI;IAEjE,MAAM,sBAAsB;QAAC;QAAY;QAAY;KAAc;IACnE,KAAK,MAAM,kBAAkB,oBAAqB;QAChD,IAAI,CAAC,wBAAwB,QAAQ,CAAC,iBAAiB;YACrD,MAAM,GAAG,gBAAgB,CAAC;YAC1B,QAAQ,GAAG,CAAC,CAAC,YAAY,EAAE,eAAe,UAAU,CAAC;QACvD;IACF;AACF;AAEA,gCAAgC;AAChC,wCAA4C;IAC1C,iEAAiE;IACjE,IAAI,CAAC,yDAAO,mBAAmB,EAAE;QAC/B,SAAS,IAAI,sHAAW,CAAC;QACzB,yDAAO,mBAAmB,GAAG,OAAO,OAAO,GAAG,IAAI,CAAC,CAAC;YAClD,kBAAkB;YAClB,OAAO;QACT;IACF;IACA,gBAAgB,yDAAO,mBAAmB;AAC5C;;uCASe","debugId":null}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sachin%20Mehta/VITMUN_backend/VITMUN-26/src/app/api/admin/external-delegates/route.ts"],"sourcesContent":["import clientPromise from \"../../../../../lib/mongodb\";\r\nimport { NextResponse, NextRequest } from \"next/server\";\r\n\r\n\r\n\r\nexport async function GET(req: NextRequest) {\r\n  // Get authentication details\r\n  // const { userId } = getAuth(req);\r\n\r\n  // // If not authenticated, return a 401 Unauthorized response\r\n  // if (!userId) {\r\n  //   return NextResponse.json({ error: \"Bad auth!\" }, { status: 401 });\r\n  // }\r\n\r\n  try {\r\n    // Proceed with database operations\r\n    console.log(\"req\", req);\r\n    const client = await clientPromise;\r\n    const db = client.db(\"delegateallotments\");\r\n    const collection = db.collection(\"external\");\r\n\r\n    // Fetch the data from MongoDB\r\n    const data = await collection.find({}).toArray();\r\n\r\n    // Return data as JSON\r\n    return NextResponse.json({ data });\r\n  } catch (error) {\r\n    // Handle errors gracefully\r\n    console.error(\"Database fetch error:\", error);\r\n    return NextResponse.json(\r\n      { error: \"Failed to fetch data from the database\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAIO,eAAe,IAAI,GAAgB;IACxC,6BAA6B;IAC7B,mCAAmC;IAEnC,8DAA8D;IAC9D,iBAAiB;IACjB,uEAAuE;IACvE,IAAI;IAEJ,IAAI;QACF,mCAAmC;QACnC,QAAQ,GAAG,CAAC,OAAO;QACnB,MAAM,SAAS,MAAM,2HAAa;QAClC,MAAM,KAAK,OAAO,EAAE,CAAC;QACrB,MAAM,aAAa,GAAG,UAAU,CAAC;QAEjC,8BAA8B;QAC9B,MAAM,OAAO,MAAM,WAAW,IAAI,CAAC,CAAC,GAAG,OAAO;QAE9C,sBAAsB;QACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAK;IAClC,EAAE,OAAO,OAAO;QACd,2BAA2B;QAC3B,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAyC,GAClD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}